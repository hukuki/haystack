# To allow your IDE to autocomplete and validate your YAML pipelines, name them as <name of your choice>.haystack-pipeline.yml

version: ignore

components:    # define all the building-blocks for Pipeline
  - name: DocumentStore
    params:
      custom_schema:
        classes:
        - class: Legislation
          invertedIndexConfig:
            bm25:
              b: 0.75
              k1: 1.2
            cleanupIntervalSeconds: 60
            stopwords:
              additions: null
              preset: en
              removals: null
          multiTenancyConfig:
            enabled: false
          properties:
          - dataType:
            - text
            description: This property was generated by Weaviate's auto-schema feature
              on Fri Aug 18 08:13:59 2023
            indexFilterable: true
            indexSearchable: true
            name: content
            tokenization: word
          - dataType:
            - text
            description: This property was generated by Weaviate's auto-schema feature
              on Fri Aug 18 08:13:59 2023
            indexFilterable: true
            indexSearchable: true
            name: mevAdi
            tokenization: word
          - dataType:
            - text
            description: This property was generated by Weaviate's auto-schema feature
              on Fri Aug 18 08:13:59 2023
            indexFilterable: true
            indexSearchable: true
            name: resmiGazeteTarihiGun
            tokenization: word
          - dataType:
            - text
            description: This property was generated by Weaviate's auto-schema feature
              on Fri Aug 18 08:13:59 2023
            indexFilterable: true
            indexSearchable: true
            name: resmiGazeteTarihiAy
            tokenization: word
          - dataType:
            - text
            description: This property was generated by Weaviate's auto-schema feature
              on Fri Aug 18 08:13:59 2023
            indexFilterable: true
            indexSearchable: true
            name: resmiGazeteTarihiYil
            tokenization: word
          - dataType:
            - text
            description: This property was generated by Weaviate's auto-schema feature
              on Fri Aug 18 08:13:59 2023
            indexFilterable: true
            indexSearchable: true
            name: doc_id
            tokenization: word
          - dataType:
            - text
            description: This property was generated by Weaviate's auto-schema feature
              on Fri Aug 18 08:13:59 2023
            indexFilterable: true
            indexSearchable: true
            name: mevzuatNo
            tokenization: word
          - dataType:
            - text
            description: This property was generated by Weaviate's auto-schema feature
              on Fri Aug 18 08:13:59 2023
            indexFilterable: true
            indexSearchable: true
            name: resmiGazeteTarihi
            tokenization: word
          - dataType:
            - text
            description: This property was generated by Weaviate's auto-schema feature
              on Fri Aug 18 08:13:59 2023
            indexFilterable: true
            indexSearchable: true
            name: resmiGazeteSayisi
            tokenization: word
          replicationConfig:
            factor: 1
          shardingConfig:
            actualCount: 1
            actualVirtualCount: 128
            desiredCount: 1
            desiredVirtualCount: 128
            function: murmur3
            key: _id
            strategy: hash
            virtualPerPhysical: 128
          vectorIndexConfig:
            cleanupIntervalSeconds: 300
            distance: cosine
            dynamicEfFactor: 8
            dynamicEfMax: 500
            dynamicEfMin: 100
            ef: -1
            efConstruction: 128
            flatSearchCutoff: 40000
            maxConnections: 64
            pq:
              bitCompression: false
              centroids: 256
              enabled: false
              encoder:
                distribution: log-normal
                type: kmeans
              segments: 0
              trainingLimit: 100000
            skip: false
            vectorCacheMaxObjects: 1000000000000
          vectorIndexType: hnsw
          vectorizer: none
      host: https://casevisor1-pu6pcwnk.weaviate.network
      index: Legislation
      port: ''
    type: WeaviateDocumentStore
  - name: Retriever
    type: EmbeddingRetriever
    params:
      document_store: DocumentStore    # params can reference other components defined in the YAML
      top_k: 100
      use_auth_token: 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
      embedding_model: atakankara/distilbert-biencoder-msmarco-tr
      max_seq_len: 300
  - name: Ranker
    type: SentenceTransformersRanker
    params:
      model_name_or_path: atakankara/bert-cross-encoder-msmarco-tr
      use_auth_token: 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
      top_k: 20
  - name: JsonFileConverter
    type: JsonConverter

pipelines:
  - name: query    # a sample extractive-qa Pipeline
    nodes:
      - name: Retriever
        inputs: [Query]
      - name: Ranker
        inputs: [Retriever]
  - name: indexing
    nodes:
      - name: JsonFileConverter
        inputs: [File]
      - name: DocumentStore
        inputs: [JsonFileConverter]
